{"ast":null,"code":"import { Estado } from \"../models/Estado\";\nexport class CellService {\n  generarTablero(filas, columnas, minas) {\n    let tablero = [];\n    for (let i = 0; i < filas; i++) {\n      let fila = [];\n      for (let j = 0; j < columnas; j++) {\n        let celda = {\n          status: 'toOpen',\n          mina: false,\n          minasAlrededor: 0\n        };\n        fila.push(celda);\n      }\n      tablero.push(fila);\n    }\n    this.generarMinas(minas, tablero, filas, columnas);\n    this.obtenerMinasAlrededor(tablero, filas, columnas);\n    return tablero;\n  }\n  generarMinas(minas, tablero, filas, columnas) {\n    let set = new Set();\n    let i;\n    for (i = 0; i < minas; i++) {\n      let pairs = [Math.floor(Math.random() * filas), Math.floor(Math.random() * columnas)];\n      if (!set.has(pairs) && !tablero[pairs[0]][pairs[1]].mina) {\n        set.add(pairs);\n        tablero[pairs[0]][pairs[1]].mina = true;\n      }\n    }\n    return tablero;\n  }\n  obtenerMinasAlrededor(tablero, filas, columnas) {\n    let Casillas = [[1, 1], [-1, -1], [-1, 1], [1, -1], [1, 0], [-1, 0], [0, 1], [0, -1]];\n    for (let i = 0; i < filas; i++) {\n      for (let j = 0; j < columnas; j++) {\n        let numMinas = 0;\n        for (const casilla of Casillas) {\n          if (!this.validarRango(i + casilla[0], j + casilla[1], filas, columnas)) {\n            continue;\n          }\n          if (tablero[i + casilla[0]][j + casilla[1]].mina) {\n            numMinas++;\n          }\n        }\n        tablero[i][j].minasAlrededor = numMinas;\n      }\n    }\n    return tablero;\n  }\n  verificarEstadoCasilla(board) {\n    for (let i = 0; i < board.length; i++) {\n      for (let j = 0; j < board[i].length; j++) {\n        if (board[i][j].mina) {\n          board[i][j].status = 'mine';\n        }\n      }\n    }\n  }\n  Dificultad(difficulty) {\n    let rows,\n      columns = 5;\n    let numberOfMines = 1;\n    if (difficulty == \"Facil\") {\n      rows = columns = 8;\n      numberOfMines = 12;\n    } else if (difficulty == \"Medio\") {\n      rows = columns = 12;\n      numberOfMines = 20;\n    } else if (difficulty == \"Dificil\") {\n      rows = columns = 18;\n      numberOfMines = 35;\n    } else {\n      rows = columns = 50;\n      numberOfMines = 100;\n    }\n    return [rows, columns, numberOfMines];\n  }\n  cambiarEstado(board, row, column, cellsGame, numberOfMines, gameEstate) {\n    if (board[row][column].mina) {\n      board[row][column].status = 'mine';\n      this.verificarEstadoCasilla(board);\n      return Estado.noactivo;\n    } else if (cellsGame.cellsOpened >= cellsGame.cells - cellsGame.numberMines) {\n      return Estado.victoria;\n    }\n    return Estado.activo;\n  }\n  validarRango(i, j, rows, columns) {\n    if (i < 0 || j < 0 || i >= rows || j >= columns) {\n      return false;\n    }\n    return true;\n  }\n  abrirCelda(tablero, fila, columna, filas, columnas, casillas) {\n    if (!this.validarRango(fila, columna, filas, columnas) || tablero[fila][columna].status == 'open' || tablero[fila][columna].mina) {\n      return;\n    } else if (tablero[fila][columna].minasAlrededor != 0) {\n      tablero[fila][columna].status = 'open';\n      casillas.cellsOpened += 1;\n    } else if (tablero[fila][columna].minasAlrededor == 0) {\n      tablero[fila][columna].status = 'open';\n      casillas.cellsOpened += 1;\n      this.abrirCelda(tablero, fila + 1, columna, filas, columnas, casillas);\n      this.abrirCelda(tablero, fila, columna + 1, filas, columnas, casillas);\n      this.abrirCelda(tablero, fila - 1, columna, filas, columnas, casillas);\n      this.abrirCelda(tablero, fila, columna - 1, filas, columnas, casillas);\n      this.abrirCelda(tablero, fila + 1, columna + 1, filas, columnas, casillas);\n      this.abrirCelda(tablero, fila + 1, columna - 1, filas, columnas, casillas);\n      this.abrirCelda(tablero, fila - 1, columna - 1, filas, columnas, casillas);\n      this.abrirCelda(tablero, fila - 1, columna + 1, filas, columnas, casillas);\n    }\n  }\n}","map":{"version":3,"mappings":"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","names":["Estado","CellService","generarTablero","filas","columnas","minas","tablero","i","fila","j","celda","status","mina","minasAlrededor","push","generarMinas","obtenerMinasAlrededor","set","Set","pairs","Math","floor","random","has","add","Casillas","numMinas","casilla","validarRango","verificarEstadoCasilla","board","length","Dificultad","difficulty","rows","columns","numberOfMines","cambiarEstado","row","column","cellsGame","gameEstate","noactivo","cellsOpened","cells","numberMines","victoria","activo","abrirCelda","columna","casillas"],"sourceRoot":"","sources":["F:\\Diky\\Desktop\\Programacio II\\Buscaminas\\src\\app\\services\\Cell.service.ts"],"sourcesContent":["import { Cell } from \"../models/Cell\";\r\nimport { Estado } from \"../models/Estado\";\r\n\r\nexport class CellService{\r\n\r\n    generarTablero(filas: number, columnas: number, minas: number) : Cell[][]{\r\n\r\n        let tablero: Cell[][] = []\r\n        for(let i = 0; i < filas; i++){\r\n            let fila: Cell[] = [];\r\n            for(let j = 0; j < columnas; j++){\r\n              let celda: Cell = {status: 'toOpen', mina: false, minasAlrededor: 0};\r\n              fila.push(celda);\r\n            }\r\n            tablero.push(fila);\r\n        }\r\n        this.generarMinas(minas, tablero, filas, columnas);\r\n        this.obtenerMinasAlrededor(tablero, filas, columnas);\r\n        return tablero;\r\n    }\r\n\r\n    generarMinas(minas: number, tablero: Cell[][], filas: number, columnas: number) : Cell[][]{\r\n        let set = new Set<([number, number])>;\r\n        let i: number;\r\n        for(i = 0; i < minas; i++){\r\n            let pairs: [number, number] = [Math.floor(Math.random() * (filas)), Math.floor(Math.random() * (columnas))];\r\n            if(!set.has(pairs) && !tablero[pairs[0]][pairs[1]].mina){\r\n                set.add(pairs);\r\n                tablero[pairs[0]][pairs[1]].mina = true;\r\n            }\r\n        }\r\n        return tablero;\r\n    }\r\n\r\n    obtenerMinasAlrededor(tablero: Cell[][], filas: number, columnas: number) : Cell[][]{\r\n        let Casillas: number[][] = [ [1, 1], [-1, -1], [-1, 1], [1, -1], [1, 0], [-1, 0], [0, 1], [0, -1] ];\r\n        for(let i = 0; i < filas; i++){\r\n            for(let j = 0; j < columnas; j++){\r\n                let numMinas: number = 0;\r\n                for(const casilla of Casillas){\r\n                    if(!this.validarRango(i + casilla[0], j + casilla[1], filas, columnas)){\r\n                        continue;\r\n                    }\r\n                    if(tablero[i + casilla[0]][ j + casilla[1]].mina){\r\n                        numMinas++;\r\n                    }\r\n                }\r\n                tablero[i][j].minasAlrededor = numMinas;\r\n            }\r\n        }\r\n        return tablero;\r\n    }\r\n\r\n\r\n    verificarEstadoCasilla(board: Cell[][]){\r\n        for(let i = 0; i < board.length; i++){\r\n            for(let j = 0; j < board[i].length; j++){\r\n                if(board[i][j].mina){\r\n                    board[i][j].status = 'mine';\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    Dificultad(difficulty: string) : [number, number, number]{\r\n\r\n        let rows, columns = 5;\r\n        let numberOfMines = 1;\r\n        if(difficulty == \"Facil\"){\r\n            rows = columns = 8;\r\n            numberOfMines = 12;\r\n        }\r\n        else if(difficulty == \"Medio\"){\r\n            rows = columns = 12;\r\n            numberOfMines = 20;\r\n        }\r\n        else if(difficulty == \"Dificil\"){\r\n            rows = columns = 18;\r\n            numberOfMines = 35;\r\n        }\r\n        else{\r\n            rows = columns = 50;\r\n            numberOfMines = 100;\r\n        }\r\n        return [rows, columns, numberOfMines];\r\n    }\r\n\r\n\r\n    cambiarEstado(board: Cell[][], row: number, column: number, cellsGame: any, numberOfMines: number, gameEstate: Estado) : Estado{\r\n        \r\n        if(board[row][column].mina){\r\n            board[row][column].status = 'mine';\r\n            this.verificarEstadoCasilla(board);\r\n            return Estado.noactivo;\r\n        }\r\n        else if((cellsGame.cellsOpened) >= (cellsGame.cells - cellsGame.numberMines)){\r\n            return Estado.victoria;\r\n        }\r\n    \r\n        return Estado.activo;\r\n    }\r\n\r\n    validarRango(i: number, j: number, rows: number, columns: number) : boolean{\r\n        if((i < 0 || j < 0) || (i >= rows || j >= columns)){\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    abrirCelda(tablero: Cell[][],fila: number, columna: number, filas: number, columnas: number, casillas: any) : void {\r\n        if(!this.validarRango(fila, columna, filas, columnas) || tablero[fila][columna].status == 'open' || tablero[fila][columna].mina){\r\n            return;\r\n        }\r\n        else if(tablero[fila][columna].minasAlrededor != 0){\r\n            tablero[fila][columna].status = 'open';\r\n            casillas.cellsOpened += 1;\r\n        }\r\n        else if(tablero[fila][columna].minasAlrededor == 0){\r\n            tablero[fila][columna].status = 'open';\r\n            casillas.cellsOpened += 1;\r\n            this.abrirCelda(tablero, fila + 1, columna, filas, columnas, casillas);\r\n            this.abrirCelda(tablero, fila, columna + 1, filas, columnas, casillas);\r\n            this.abrirCelda(tablero, fila - 1, columna, filas, columnas, casillas);\r\n            this.abrirCelda(tablero, fila, columna - 1, filas, columnas, casillas);\r\n            this.abrirCelda(tablero, fila + 1, columna + 1, filas, columnas, casillas);\r\n            this.abrirCelda(tablero, fila + 1, columna - 1, filas, columnas, casillas);\r\n            this.abrirCelda(tablero, fila - 1, columna - 1, filas, columnas, casillas);\r\n            this.abrirCelda(tablero, fila - 1, columna + 1, filas, columnas, casillas);\r\n            \r\n        }\r\n    }\r\n\r\n}"]},"metadata":{},"sourceType":"module","externalDependencies":[]}